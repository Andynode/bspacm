<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9"/>
<title>BSPACM: device/tm4c/include/bspacm/periph/gpio.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BSPACM
   &#160;<span id="projectnumber">20150113</span>
   </div>
   <div id="projectbrief">Board Support Package for ARM Cortex-M Microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_820b2b9dd608784780e51ab49715a98b.html">device</a></li><li class="navelem"><a class="el" href="dir_4cea6d9a69bf7c3a4018104e88d734be.html">tm4c</a></li><li class="navelem"><a class="el" href="dir_8e3689fd2fd3ff3620ec3ae6a9aee11e.html">include</a></li><li class="navelem"><a class="el" href="dir_6b08ba2a2e9f1e42c521c6394decfa6e.html">bspacm</a></li><li class="navelem"><a class="el" href="dir_24b21c62eb8a7de6bb17f2545c5c2a2a.html">periph</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gpio.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Support for peripheral pin multiplexing configuration.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="core_8h_source.html">bspacm/core.h</a>&gt;</code><br />
</div>
<p><a href="tm4c_2include_2bspacm_2periph_2gpio_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsBSPACMdeviceTM4Cpinmux.html">sBSPACMdeviceTM4Cpinmux</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abc99b7b584aec1b9280d2d0d90717288"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html">sBSPACMdeviceTM4Cpinmux</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm4c_2include_2bspacm_2periph_2gpio_8h.html#abc99b7b584aec1b9280d2d0d90717288">sBSPACMdeviceTM4Cpinmux</a></td></tr>
<tr class="separator:abc99b7b584aec1b9280d2d0d90717288"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab52b31028bae5a77bc8264e116674608"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm4c_2include_2bspacm_2periph_2gpio_8h.html#ab52b31028bae5a77bc8264e116674608">vBSPACMdeviceTM4CpinmuxConfigure</a> (const <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html">sBSPACMdeviceTM4Cpinmux</a> *cfgp, int enablep)</td></tr>
<tr class="separator:ab52b31028bae5a77bc8264e116674608"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6d98ecd145761e88ff30bbb9bb79812"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="core_8h.html#a1d7c3e78ed005aa264211e43bf2a64c5">BSPACM_CORE_INLINE</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm4c_2include_2bspacm_2periph_2gpio_8h.html#ae6d98ecd145761e88ff30bbb9bb79812">iBSPACMdeviceTM4CgpioPortTagFromShift</a> (unsigned int shift)</td></tr>
<tr class="separator:ae6d98ecd145761e88ff30bbb9bb79812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad43a3fabd2f440771abc79c4457a257b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="core_8h.html#a1d7c3e78ed005aa264211e43bf2a64c5">BSPACM_CORE_INLINE</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tm4c_2include_2bspacm_2periph_2gpio_8h.html#ad43a3fabd2f440771abc79c4457a257b">iBSPACMdeviceTM4CgpioPortShift</a> (void *gpio)</td></tr>
<tr class="separator:ad43a3fabd2f440771abc79c4457a257b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Support for peripheral pin multiplexing configuration. </p>
<p>TM4C peripherals are mapped to specific GPIO pins; the specific peripheral function supported by a GPIO pin is determined by the value written to the corresponding GPIOPCTL port control register.</p>
<p>The mapping between pin and peripheral function is constrained by the specific device. In some cases the same function can be mapped to multiple pins; in that situation, the desired mapping may be specific to the board or even to the application.</p>
<p>This file declares arrays that provide pin mapping definitions for all peripherals that are used by the application. These mappings are used by the generic TM4C peripheral configuration routines. The application, board, or device should provide definitions for the structure corresponding to each required peripheral in a source file named <code>periph_config.c</code> with an absolute path set in the make variable <code>PERIPH_CONFIG_SRC</code>. By default the board-specific <code>periph_config.c</code> is used.</p>
<h1><a class="anchor" id="device_tm4c_gpio_howto"></a>
Configuring GPIO Pins on TM4C Microcontrollers</h1>
<p>This material adapted from my <a href="http://forum.stellarisiti.com/topic/1890-the-datasheet-book-club/?p=6412">Stellarisiti forum post on TM4C123 10.3 Initialization and Configuration steps</a>, repeated here as an easier-to-find reference:</p>
<ul>
<li>(1) Enable the module port, if not done already. Wait 3 cycles after enabling. <div class="fragment"><div class="line"><a class="code" href="core_8h.html#a55f509ffb0add02384773f2d9cf28713">BSPACM_CORE_BITBAND_PERIPH</a>(SYSCTL-&gt;RCGCGPIO, <a class="code" href="tm4c_2include_2bspacm_2periph_2gpio_8h.html#ad43a3fabd2f440771abc79c4457a257b">iBSPACMdeviceTM4CgpioPortShift</a>(GPIO_PORT)) = 1;</div>
<div class="line">__NOP(); __NOP(); __NOP(); <span class="comment">// delay 3 cycles</span></div>
</div><!-- fragment --> </li>
<li>(1.5) Unlock any bits in CR if necessary (n1) </li>
<li>(2) Configure DIR if necessary (n2) <div class="fragment"><div class="line"><a class="code" href="core_8h.html#a55f509ffb0add02384773f2d9cf28713">BSPACM_CORE_BITBAND_PERIPH</a>(GPIO_PORT-&gt;DIR, GPIO_PIN) = 1;</div>
</div><!-- fragment --> </li>
<li>(3) Configure AFSEL </li>
<li>(4) Set one of DR2R, DR4R, DR8R (n3) </li>
<li>(5a) Set PUR or PDR, or clear both (n4) </li>
<li>(5b) Configure ODR (n4) </li>
<li>(5c) Configure SLR if using 8mA drive strength </li>
<li>(6) Configure DEN and (if necessary) AMSEL </li>
<li>(7) Configure interrupts (see details in 10.3 step 7) </li>
<li>(8) Optionally restore the lock bit. Note that the description in 10.3 step 8 is misleading: this is not a bit in GPIOLOCK, it is a bit in GPIOCR which requires a set of the GPIOLOCK key before being modified.</li>
</ul>
<p>Notes: </p><ul>
<li>(n1) Bits that are JTAG/SWD pins or NMI pins; see 10.2.4 and the GPIOLOCK and GPIOCR register descriptions. In library code you can simply check the CR bit: if it's clear, modifications require the unlock process.</li>
</ul>
<ul>
<li>(n2) For some peripheral functions (e.g. UART) this bit is don't-care. See Table 10-3 "GPIO Pad Configuration Examples".</li>
</ul>
<ul>
<li>(n3) It's unclear to me whether it is meaningful to set a zero mA drive strength by clearing a bit in all three registers, although this can be done.</li>
</ul>
<ul>
<li>(n4) Table 10-3 suggests that ODR and PUR/PDR should be configured in certain cases regardless of direction, and should not be considered a "pick one of the three options" situation as implied by the description in section 10.3 step 5.</li>
</ul>
<p>TM4C129 devices have extended drive that supports 6mA, 10mA, and 12mA drive strengths, but the DR2R DR4R and DR8R registers are documented to behave the same as the TM4C123 ones. The techniques required to select these strengths are not addressed here; see a TM4C129x datasheet for details.</p>
<dl class="section user"><dt>Homepage</dt><dd><a href="http://github.com/pabigot/bspacm">http://github.com/pabigot/bspacm</a> </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2014, Peter A. Bigot. Licensed under <a href="http://www.opensource.org/licenses/BSD-3-Clause">BSD-3-Clause</a> </dd></dl>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="abc99b7b584aec1b9280d2d0d90717288"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html">sBSPACMdeviceTM4Cpinmux</a>  <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html">sBSPACMdeviceTM4Cpinmux</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Core structure associating a GPIO port, pin, and port control function.</p>
<dl class="section note"><dt>Note</dt><dd>An all-zero pinmux denotes an unconfigured GPIO due to #pctl being zero. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad43a3fabd2f440771abc79c4457a257b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="core_8h.html#a1d7c3e78ed005aa264211e43bf2a64c5">BSPACM_CORE_INLINE</a> int iBSPACMdeviceTM4CgpioPortShift </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>gpio</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Determine the bit position for a specific port within a register.</p>
<p>This maps, for example, <code>GPIOK</code> to 9 because bit 9 of a register like @ RCGCGPIO corresponds to <code>GPIOK</code>.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="tm4c_2include_2bspacm_2periph_2gpio_8h.html#ae6d98ecd145761e88ff30bbb9bb79812">iBSPACMdeviceTM4CgpioPortTagFromShift</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpio</td><td>a reference to the port instance; generically a pointer with the bit value of the port base address. You can pass <code>GPIOA</code> or  as appropriate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a non-negative shift value, or -1 if <code>gpio</code> does not appear to be a valid port address. </dd></dl>

</div>
</div>
<a class="anchor" id="ae6d98ecd145761e88ff30bbb9bb79812"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="core_8h.html#a1d7c3e78ed005aa264211e43bf2a64c5">BSPACM_CORE_INLINE</a> int iBSPACMdeviceTM4CgpioPortTagFromShift </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>shift</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Convert a port instance index (shift) to the letter tag for the port.</p>
<p>This adjustment accounts for GPIOI and GPIOO being skipped in the letter identification, with the corresponding shifts being applied to the next supported port.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">shift</td><td>the bit index for the port</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an upper-case letter corresponding to the port with 'I' and 'O' being skipped. </dd></dl>

</div>
</div>
<a class="anchor" id="ab52b31028bae5a77bc8264e116674608"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vBSPACMdeviceTM4CpinmuxConfigure </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html">sBSPACMdeviceTM4Cpinmux</a> *&#160;</td>
          <td class="paramname"><em>cfgp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enablep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the AFSEL bit and other bits required to configure a pin for a peripheral function according to <code>*cfgp</code>, or when disabled to be treated as a GPIO input.</p>
<p>Where <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html#a00a0f610b1e3782b41659c93497e051e">cfgp-&gt;pctl</a> is not zero (pin provides a peripheral function): Disabling the device disables the pin entirely (clears the DEN bit).</p>
<p>Where <code>cfg-&gt;pctl</code> is zero (pin provides GPIO): Enabling configures the pin for output; disabling configures the pin for input. This API is inadequate for full control as lacks the ability to set GPIO output initial state, or GPIO input pullup/pulldown state.</p>
<dl class="section note"><dt>Note</dt><dd>Pins that happen to be commit-control locked will be unlocked to perform this reconfiguration then re-locked.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Pins with special considerations may, when disabled, lose their special function: this routine does not return them to their power-up configuration.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cfgp</td><td>pointer to the configuration structure. If <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html#a5071df5fc76b073dc0775d2b95d15ba0">cfgp-&gt;port</a> is null, no configuration will be performed.</td></tr>
    <tr><td class="paramname">enablep</td><td>nonzero if the pin is to be configured based on <a class="el" href="structsBSPACMdeviceTM4Cpinmux.html#a00a0f610b1e3782b41659c93497e051e">cfgp-&gt;pctl</a> (it will be a GPIO output if <code>cfgp-&gt;pctl</code> is zero). If <code>enablep</code> is zero the pin will be disabled (or configured as a GPIO input if <code>cfgp-&gt;pctl</code> is zero). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 13 2015 19:58:49 for BSPACM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9
</small></address>
</body>
</html>
